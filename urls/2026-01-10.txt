https://blog.luminal.com/p/compiling-models-to-megakernels